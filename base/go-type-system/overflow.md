# Go æ•´æ•°æº¢å‡ºï¼ˆInteger Overflowï¼‰å®Œå…¨æ•™ç¨‹

## æ¦‚è¿°

æ•´æ•°æº¢å‡ºæ˜¯æŒ‡åœ¨è¿›è¡Œç®—æœ¯è¿ç®—æ—¶ï¼Œç»“æœè¶…å‡ºäº†å˜é‡ç±»å‹èƒ½è¡¨ç¤ºçš„èŒƒå›´ã€‚Go è¯­è¨€å¯¹æ•´æ•°æº¢å‡ºçš„å¤„ç†æ–¹å¼éœ€è¦ç†è§£ï¼Œä»¥é¿å…ç¨‹åºå‡ºç°æ„å¤–çš„é”™è¯¯ã€‚

---

## 1. ä»€ä¹ˆæ˜¯æ•´æ•°æº¢å‡ºï¼Ÿ

### 1.1 å®šä¹‰

æ•´æ•°æº¢å‡ºå‘ç”Ÿåœ¨ï¼š
- **æ­£æ•°æº¢å‡º**ï¼šè¶…è¿‡ç±»å‹çš„æœ€å¤§å€¼ï¼Œå›ç»•åˆ°æœ€å°å€¼
- **è´Ÿæ•°æº¢å‡º**ï¼šå°äºç±»å‹çš„æœ€å°å€¼ï¼Œå›ç»•åˆ°æœ€å¤§å€¼

### 1.2 ä¸ºä»€ä¹ˆä¼šå‘ç”Ÿæº¢å‡ºï¼Ÿ

æ¯ä¸ªæ•´æ•°ç±»å‹éƒ½æœ‰å›ºå®šçš„èŒƒå›´ï¼Œç”±å…¶ä½å®½å†³å®šï¼š

```
int8:     -128 åˆ° 127
uint8:    0 åˆ° 255
int16:    -32,768 åˆ° 32,767
uint16:   0 åˆ° 65,535
int32:    -2,147,483,648 åˆ° 2,147,483,647
uint32:   0 åˆ° 4,294,967,295
int64:    å¾ˆå¤§çš„èŒƒå›´
uint64:   å¾ˆå¤§çš„èŒƒå›´
```

å½“è¿ç®—ç»“æœè¶…å‡ºè¿™äº›èŒƒå›´æ—¶ï¼Œå°±ä¼šæº¢å‡ºã€‚

---

## 2. æœ‰ç¬¦å·æ•´æ•°æº¢å‡º

### 2.1 int8 æº¢å‡ºç¤ºä¾‹

int8 çš„èŒƒå›´æ˜¯ `-128` åˆ° `127`ã€‚

```go
package main

import (
    "fmt"
    "math"
)

func main() {
    // int8 çš„æœ€å¤§å€¼
    var n int8 = math.MaxInt8  // 127
    
    fmt.Println("max int8     :", n)      // è¾“å‡º: 127
    fmt.Println("max int8 + 1 :", n+1)   // è¾“å‡º: -128ï¼ˆæº¢å‡ºï¼ï¼‰
}
```

**ä¸ºä»€ä¹ˆ 127 + 1 = -128ï¼Ÿ**

åœ¨äºŒè¿›åˆ¶ä¸­ï¼ˆ8ä½ï¼‰ï¼š
```
127    = 01111111
+1     = 00000001
-----------
ç»“æœ   = 10000000 = -128ï¼ˆæœ€å°å€¼ï¼‰
```

### 2.2 è´Ÿæ•°æº¢å‡º

```go
package main

import (
    "fmt"
    "math"
)

func main() {
    // int8 çš„æœ€å°å€¼
    var n int8 = math.MinInt8  // -128
    
    fmt.Println("min int8     :", n)      // è¾“å‡º: -128
    fmt.Println("min int8 - 1 :", n-1)   // è¾“å‡º: 127ï¼ˆæº¢å‡ºï¼ï¼‰
}
```

**ä¸ºä»€ä¹ˆ -128 - 1 = 127ï¼Ÿ**

```
-128   = 10000000
-1     = 11111111
-----------
ç»“æœ   = 01111111 = 127ï¼ˆæœ€å¤§å€¼ï¼‰
```

---

## 3. æ— ç¬¦å·æ•´æ•°æº¢å‡º

### 3.1 uint8 æº¢å‡ºç¤ºä¾‹

uint8 çš„èŒƒå›´æ˜¯ `0` åˆ° `255`ã€‚

```go
package main

import (
    "fmt"
    "math"
)

func main() {
    // uint8 çš„åˆå§‹å€¼ä¸º 0
    var un uint8 = 0
    
    fmt.Println("min uint8    :", un)      // è¾“å‡º: 0
    fmt.Println("min uint8 - 1:", un-1)   // è¾“å‡º: 255ï¼ˆæº¢å‡ºï¼ï¼‰
    
    // uint8 çš„æœ€å¤§å€¼
    un = math.MaxUint8  // 255
    
    fmt.Println("max uint8    :", un)      // è¾“å‡º: 255
    fmt.Println("max uint8 + 1:", un+1)   // è¾“å‡º: 0ï¼ˆæº¢å‡ºï¼ï¼‰
}
```

**ä¸ºä»€ä¹ˆ 0 - 1 = 255ï¼Ÿ**

å¯¹äºæ— ç¬¦å·æ•´æ•°ï¼š
```
0      = 00000000
-1     = 11111111 = 255ï¼ˆæœ€å¤§å€¼ï¼‰
```

**ä¸ºä»€ä¹ˆ 255 + 1 = 0ï¼Ÿ**

```
255    = 11111111
+1     = 00000001
-----------
ç»“æœ   = 00000000 = 0ï¼ˆæœ€å°å€¼ï¼Œè¿›ä½è¢«ä¸¢å¼ƒï¼‰
```

---

## 4. æµ®ç‚¹æ•°æº¢å‡º

### 4.1 æµ®ç‚¹æ•°çš„ç‰¹æ®Šè¡Œä¸º

æµ®ç‚¹æ•°ä¸ä¼šåƒæ•´æ•°é‚£æ ·å›ç»•ã€‚å½“æµ®ç‚¹æ•°è¶…å‡ºèŒƒå›´æ—¶ï¼Œä¼šå˜æˆ **æ— ç©·å¤§**ã€‚

```go
package main

import (
    "fmt"
    "math"
)

func main() {
    f := float32(math.MaxFloat32)
    
    fmt.Println("max float32      :", f)        // è¾“å‡º: 3.4028235e+38
    fmt.Println("max float32 * 1.2:", f*1.2)   // è¾“å‡º: +Infï¼ˆæ— ç©·å¤§ï¼‰
}
```

---

## 5. Go çš„æº¢å‡ºæ£€æŸ¥æœºåˆ¶

### 5.1 ç¼–è¯‘æ—¶æ£€æŸ¥

Go ç¼–è¯‘å™¨ä¼šåœ¨**ç¼–è¯‘æ—¶**æ£€æµ‹æŸäº›æº¢å‡ºï¼š

```go
// âŒ ç¼–è¯‘é”™è¯¯ï¼šç¼–è¯‘å™¨æ£€æµ‹åˆ°æº¢å‡º
fmt.Println(int8(128))  // 128 è¶…å‡º int8 èŒƒå›´
```

**é”™è¯¯ä¿¡æ¯**ï¼š
```
constant 128 overflows int8
```

### 5.2 è¿è¡Œæ—¶æ— æ³•æ£€æŸ¥

Go **ä¸èƒ½**åœ¨è¿è¡Œæ—¶è‡ªåŠ¨æ£€æµ‹æº¢å‡ºã€‚å½“æº¢å‡ºå‘ç”Ÿæ—¶ï¼Œå€¼ä¼šé™é»˜åœ°å›ç»•ï¼š

```go
package main

import (
    "fmt"
    "math"
)

func main() {
    var n int8 = math.MaxInt8  // 127
    n++  // é™é»˜æº¢å‡ºï¼Œn å˜æˆ -128
    
    fmt.Println(n)  // è¾“å‡º: -128ï¼ˆæ²¡æœ‰é”™è¯¯æˆ–è­¦å‘Šï¼‰
}
```

---

## 6. å®é™…é—®é¢˜ç¤ºä¾‹

### 6.1 é—®é¢˜ä»£ç 

```go
package main

import "fmt"

func main() {
    var (
        width  uint8 = 255
        height       = 255  // int ç±»å‹
    )
    
    width++  // æº¢å‡ºï¼width å˜æˆ 0
    
    if int(width) < height {
        fmt.Println("height is greater")
    }
    
    fmt.Printf("width: %d height: %d\n", width, height)
    // è¾“å‡º: 
    // height is greater
    // width: 0 height: 255
}
```

**åˆ†æ**ï¼š
1. `width` æ˜¯ `uint8`ï¼Œåˆå§‹å€¼ä¸º `255`
2. `width++` å¯¼è‡´æº¢å‡ºï¼Œ`width` å˜æˆ `0`
3. `int(0) < 255` ä¸º `true`ï¼Œæ‰€ä»¥æ‰“å° "height is greater"
4. æœ€ç»ˆè¾“å‡ºæ˜¾ç¤º `width: 0`ï¼Œè¿™ä¸æ˜¯é¢„æœŸçš„ç»“æœ

---

## 7. ç±»å‹è½¬æ¢çš„æ•°æ®ä¸¢å¤±

### 7.1 ä»å¤§ç±»å‹è½¬æ¢åˆ°å°ç±»å‹

å½“ä»å¤§èŒƒå›´çš„ç±»å‹è½¬æ¢åˆ°å°èŒƒå›´çš„ç±»å‹æ—¶ï¼Œé«˜ä½ä¼šè¢«æˆªæ–­ï¼š

```go
package main

import "fmt"

func main() {
    // uint16 çš„æœ€å¤§å€¼æ˜¯ 65535
    big := uint16(65535)
    
    // è½¬æ¢åˆ° uint8ï¼ˆåªèƒ½è¡¨ç¤º 0-255ï¼‰
    small := uint8(big)
    
    fmt.Printf("big   : %016b %d\n", big, big)
    fmt.Printf("small : %016b %d\n", small, small)
}
```

**è¾“å‡º**ï¼š
```
big   : 1111111111111111 65535
small : 1111111111111111 255
```

**ä¸ºä»€ä¹ˆï¼Ÿ**

```
big   = 1111111111111111 (å®Œæ•´çš„ 16 ä½)
             ||||||||
small =      11111111 (åªå–ä½ 8 ä½ï¼Œé«˜ä½ä¸¢å¤±)
```

65535 çš„äºŒè¿›åˆ¶æ˜¯ `1111 1111 1111 1111`ï¼Œä½† uint8 åªèƒ½å­˜å‚¨ 8 ä½ï¼Œæ‰€ä»¥åªä¿ç•™ä½ 8 ä½ `1111 1111 = 255`ã€‚

---

## 8. å¦‚ä½•é¿å…æº¢å‡º

### 8.1 âœ… ä½¿ç”¨æ›´å¤§çš„æ•°æ®ç±»å‹

```go
// âŒ å®¹æ˜“æº¢å‡º
var count uint8 = 255
count++  // æº¢å‡ºï¼

// âœ… ä½¿ç”¨æ›´å¤§çš„ç±»å‹
var count int32 = 255
count++  // æ­£å¸¸ï¼Œcount = 256
```

### 8.2 âœ… è¾¹ç•Œæ£€æŸ¥

```go
package main

import (
    "fmt"
    "math"
)

func main() {
    var n int8 = math.MaxInt8
    
    // æ£€æŸ¥æ˜¯å¦ä¼šæº¢å‡º
    if n < math.MaxInt8 {
        n++
    } else {
        fmt.Println("Cannot increment: would overflow")
    }
}
```

### 8.3 âœ… ç±»å‹è½¬æ¢å‰æ£€æŸ¥

```go
package main

import (
    "fmt"
    "math"
)

func main() {
    big := uint32(65536)
    
    // æ£€æŸ¥æ˜¯å¦åœ¨ uint8 èŒƒå›´å†…
    if big <= math.MaxUint8 {
        small := uint8(big)
        fmt.Println(small)
    } else {
        fmt.Println("Value too large for uint8")
    }
}
```

### 8.4 âœ… è¿ç®—æ—¶ä½¿ç”¨å¤§ç±»å‹

```go
// âŒ å¯èƒ½æº¢å‡º
var a uint8 = 200
var b uint8 = 100
result := a + b  // å¯èƒ½æº¢å‡º

// âœ… åœ¨å¤§ç±»å‹ä¸­è®¡ç®—
a_large := uint16(a)
b_large := uint16(b)
result := a_large + b_large  // ä¸ä¼šæº¢å‡º
```

---

## 9. æ•´æ•°èŒƒå›´å‚è€ƒè¡¨

### 9.1 æœ‰ç¬¦å·æ•´æ•°

| ç±»å‹ | ä½å®½ | æœ€å°å€¼ | æœ€å¤§å€¼ | å­—èŠ‚æ•° |
|------|------|--------|--------|--------|
| `int8` | 8 | -128 | 127 | 1 |
| `int16` | 16 | -32,768 | 32,767 | 2 |
| `int32` (rune) | 32 | -2,147,483,648 | 2,147,483,647 | 4 |
| `int64` | 64 | -9,223,372,036,854,775,808 | 9,223,372,036,854,775,807 | 8 |
| `int` | ä¾èµ–å¹³å° | æœ€å°å€¼ | æœ€å¤§å€¼ | 8 æˆ– 4 |

### 9.2 æ— ç¬¦å·æ•´æ•°

| ç±»å‹ | ä½å®½ | æœ€å°å€¼ | æœ€å¤§å€¼ | å­—èŠ‚æ•° |
|------|------|--------|--------|--------|
| `uint8` (byte) | 8 | 0 | 255 | 1 |
| `uint16` | 16 | 0 | 65,535 | 2 |
| `uint32` | 32 | 0 | 4,294,967,295 | 4 |
| `uint64` | 64 | 0 | 18,446,744,073,709,551,615 | 8 |
| `uint` | ä¾èµ–å¹³å° | 0 | æœ€å¤§å€¼ | 8 æˆ– 4 |

---

## 10. æŸ¥è¯¢æ•´æ•°èŒƒå›´çš„æ–¹æ³•

### 10.1 ä½¿ç”¨ math åŒ…

```go
package main

import (
    "fmt"
    "math"
)

func main() {
    fmt.Println("int8 èŒƒå›´:", math.MinInt8, "åˆ°", math.MaxInt8)
    fmt.Println("int16 èŒƒå›´:", math.MinInt16, "åˆ°", math.MaxInt16)
    fmt.Println("int32 èŒƒå›´:", math.MinInt32, "åˆ°", math.MaxInt32)
    fmt.Println("int64 èŒƒå›´:", math.MinInt64, "åˆ°", math.MaxInt64)
    
    fmt.Println("uint8 èŒƒå›´: 0 åˆ°", math.MaxUint8)
    fmt.Println("uint16 èŒƒå›´: 0 åˆ°", math.MaxUint16)
    fmt.Println("uint32 èŒƒå›´: 0 åˆ°", math.MaxUint32)
    fmt.Println("uint64 èŒƒå›´: 0 åˆ°", math.MaxUint64)
}
```

---

## 11. å¸¸è§æº¢å‡ºåœºæ™¯

### 11.1 å¾ªç¯è®¡æ•°å™¨

```go
// âŒ å¦‚æœå¾ªç¯æ¬¡æ•°è¶…è¿‡ 255ï¼Œä¼šæº¢å‡º
var i uint8 = 0
for i = 0; i < 1000; i++ {
    fmt.Println(i)  // i ä¼šä» 0-255 åå¤å¾ªç¯
}

// âœ… ä½¿ç”¨ int ä»£æ›¿
for i := 0; i < 1000; i++ {
    fmt.Println(i)
}
```

### 11.2 å¤§æ•°å€¼è®¡ç®—

```go
// âŒ ä¸­é—´ç»“æœå¯èƒ½æº¢å‡º
var a int16 = 32000
var b int16 = 32000
result := a * b  // æº¢å‡ºï¼

// âœ… è½¬æ¢ä¸ºå¤§ç±»å‹å†è®¡ç®—
aLarge := int64(a)
bLarge := int64(b)
result := aLarge * bLarge  // æ­£å¸¸
```

### 11.3 æ•°ç»„ç´¢å¼•

```go
// âŒ ä¸å®‰å…¨çš„ç´¢å¼•è®¡ç®—
var index uint8 = 255
arr := []int{1, 2, 3}
index++  // index å˜æˆ 0
// arr[index] ç°åœ¨è®¿é—® arr[0] è€Œä¸æ˜¯æœŸæœ›çš„ä½ç½®
```

---

## 12. æº¢å‡ºé—®é¢˜æ€»ç»“è¡¨

| æƒ…å†µ | int8 ç¤ºä¾‹ | ç»“æœ | åŸå›  |
|------|-----------|------|------|
| æœ€å¤§å€¼+1 | 127+1 | -128 | æ­£å‘æº¢å‡ºå›ç»• |
| æœ€å°å€¼-1 | -128-1 | 127 | è´Ÿå‘æº¢å‡ºå›ç»• |
| uint8 æœ€å°å€¼-1 | 0-1 | 255 | æ— ç¬¦å·æº¢å‡ºå›ç»• |
| uint8 æœ€å¤§å€¼+1 | 255+1 | 0 | æ— ç¬¦å·æº¢å‡ºå›ç»• |
| ç±»å‹è½¬æ¢ä¸¢å¤± | uint16(65535) â†’ uint8 | 255 | é«˜ä½è¢«æˆªæ–­ |

---

## 13. æœ€ä½³å®è·µ

### âœ… è¯¥åšçš„äº‹

| åšæ³• | è¯´æ˜ |
|------|------|
| âœ… ä¸ºè¿ç®—é€‰æ‹©åˆé€‚çš„ç±»å‹ | æ ¹æ®æ•°å€¼èŒƒå›´é€‰æ‹©ç±»å‹ |
| âœ… ä½¿ç”¨æ›´å¤§çš„ç±»å‹è¿›è¡Œä¸­é—´è®¡ç®— | é¿å…ä¸­é—´æº¢å‡º |
| âœ… è¿›è¡Œè¾¹ç•Œæ£€æŸ¥ | åœ¨å…³é”®ä½ç½®æ£€æŸ¥èŒƒå›´ |
| âœ… äº†è§£ç±»å‹çš„èŒƒå›´ | æ¸…æ¥šæ¯ä¸ªç±»å‹èƒ½è¡¨ç¤ºçš„èŒƒå›´ |
| âœ… æ–‡æ¡£ä¸­æ ‡æ³¨èŒƒå›´é™åˆ¶ | å‘ŠçŸ¥ä½¿ç”¨è€…çš„é™åˆ¶ |

### âŒ ä¸è¯¥åšçš„äº‹

| é¿å… | åŸå›  |
|------|------|
| âŒ éšæ„é€‰æ‹©å°ç±»å‹ | å®¹æ˜“å¯¼è‡´æº¢å‡º |
| âŒ å‡è®¾æº¢å‡ºä¼šæŠ¥é”™ | Go ä¸ä¼šè‡ªåŠ¨æ£€æŸ¥è¿è¡Œæ—¶æº¢å‡º |
| âŒ å¿½è§†ç±»å‹è½¬æ¢æŸå¤± | å¤§ç±»å‹è½¬å°ç±»å‹ä¼šä¸¢å¤±é«˜ä½ |
| âŒ ç›´æ¥ä½¿ç”¨ç”¨æˆ·è¾“å…¥ | ç”¨æˆ·è¾“å…¥å¯èƒ½è¶…å‡ºèŒƒå›´ |
| âŒ è¿‡åº¦ä½¿ç”¨ uint8/int8 | é™¤éæœ‰ç‰¹æ®ŠåŸå›  |

---

## æ€»ç»“

### å…³é”®è¦ç‚¹

1. **Go ä¸ä¼šè‡ªåŠ¨æ£€æŸ¥è¿è¡Œæ—¶æº¢å‡º** - æº¢å‡ºä¼šé™é»˜å‘ç”Ÿï¼Œå€¼ä¼šå›ç»•
2. **ç¼–è¯‘æ—¶å¯ä»¥æ£€æŸ¥å¸¸é‡æº¢å‡º** - ç¼–è¯‘å™¨ä¼šæ‹’ç»æ˜æ˜¾çš„æº¢å‡º
3. **æœ‰ç¬¦å·æ•´æ•°æº¢å‡º**ï¼šè¶…å‡ºæœ€å¤§å€¼å›ç»•åˆ°æœ€å°å€¼ï¼Œåä¹‹äº¦ç„¶
4. **æ— ç¬¦å·æ•´æ•°æº¢å‡º**ï¼šç›¸åŒçš„å›ç»•è¡Œä¸ºï¼Œä½†ä¸æ¶‰åŠè´Ÿæ•°
5. **æµ®ç‚¹æ•°æº¢å‡º**ï¼šå˜æˆ `+Inf` æˆ– `-Inf`
6. **ç±»å‹è½¬æ¢å¯èƒ½ä¸¢å¤±æ•°æ®**ï¼šä»å¤§ç±»å‹è½¬å°ç±»å‹æ—¶æˆªæ–­é«˜ä½

### å¿«é€Ÿæ£€æŸ¥æ¸…å•

- [ ] äº†è§£ä½ æ­£åœ¨ä½¿ç”¨çš„æ•´æ•°ç±»å‹çš„èŒƒå›´ï¼Ÿ
- [ ] æ£€æŸ¥è¿‡æ˜¯å¦æœ‰æº¢å‡ºé£é™©ï¼Ÿ
- [ ] è¿›è¡Œäº†å¿…è¦çš„è¾¹ç•Œæ£€æŸ¥ï¼Ÿ
- [ ] ç±»å‹è½¬æ¢æ—¶è€ƒè™‘è¿‡æ•°æ®ä¸¢å¤±ï¼Ÿ
- [ ] å¤§æ•°å€¼è®¡ç®—æ—¶ä½¿ç”¨äº†è¶³å¤Ÿå¤§çš„ç±»å‹ï¼Ÿ

æŒæ¡æ•´æ•°æº¢å‡ºçš„æ¦‚å¿µå¯¹äºç¼–å†™æ­£ç¡®ã€å¯é çš„ Go ç¨‹åºè‡³å…³é‡è¦ï¼ğŸ¯
